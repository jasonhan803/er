!function(e){var t={};function n(o){if(t[o])return t[o].exports;var u=t[o]={i:o,l:!1,exports:{}};return e[o].call(u.exports,u,u.exports,n),u.l=!0,u.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var u in e)n.d(o,u,function(t){return e[t]}.bind(null,u));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t){var n="aca376f206b8fc25a6ed44dbdc66547c36c6c33e3a119ffbeaef943642f0e906",o=null,u=0,i="",d=0,a=-1,l=0,c=!1,r="",m=null,s=null,f=0,g="";function y(){var e=function(e){for(var t='ABCD1EF!GHIJK=LMN2OPQR3S;TUVWXYZ"abcdefghijklmnopqrstu/vwxyz123|4567890',n="",o=0;o<e;o++)n+=t.charAt(Math.floor(Math.random()*t.length));return n}(64).toLowerCase();return sha256(e)+" 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38"}function b(){if(0!=u){if(-1==a)return E("等待检测余额"),void setTimeout(b,1e3);if(p(),l>0&&a<=l)E("余额达到限制边界，已经停止");else if(""!=i){if(!c)return E("CPU资源不足"+r+"，等待CPU释放后继续"),void setTimeout(b,1e3);if(null==s)return E("请登陆"),void setTimeout(b,1e3);var e={from:L(),to:"rouletteplay",quantity:i,memo:y()};E(new Date+" "+JSON.stringify(e)),x(e.to,e.quantity,e.memo,function(e){E(new Date+" 交易ID: "+e.transaction_id),d>0?(E(new Date+" 等待 ${timeout}ms"),setTimeout(b,d)):b()},function(e){var t=void 0==e.message?JSON.parse(e).error.details[0].message:e.message;if("User rejected the signature request"==t||"Invalid packed transaction"==t)return E(new Date+" 用户取消，已经停止。"),void B();E(new Date+' 发现错误："'+t+'"'),d>0?(E(new Date+" 等待 "+d+"ms"),setTimeout(b,d)):b()})}else E("请输入下注金额")}else E("已经停止")}function E(e){var t=document.getElementById("txtResults"),n=t.innerHTML,o=""==n?[]:n.split("\n"),u=o.length-100;u>0&&o.splice(0,u),o.push(e),t.innerHTML=o.join("\n"),t.scrollTop=t.scrollHeight}function v(){var e=document.getElementById("txtHttpEndpoint").value.split("://"),t=e[1].split(":");m={blockchain:"eos",host:t[0],port:t.length>1?t[1]:"https"==e[0].toLowerCase()?443:80,chainId:n,protocol:e[0]},o=scatter.eos(m,Eos,{expireInSeconds:60},"https"),E("网络参数："+JSON.stringify(m))}function p(){document.getElementById("txtReferrals").value,i=document.getElementById("txtAmount").value,d=new Number(document.getElementById("txtTimeout").value).valueOf(),l=new Number(document.getElementById("txtBalanceUnder").value).valueOf(),f=new Number(document.getElementById("txtCPUUnder").value).valueOf(),isNaN(d)&&(d=0),isNaN(l)&&(l=0),isNaN(f)&&(f=0)}function I(){1!=u&&(null!=s?(p(),v(),u=1,T(!0),document.getElementById("txtResults").innerHTML="",setTimeout(b,1e3)):alert("请登陆"))}function B(){u=0,T(!1)}function T(e){document.getElementById("txtHttpEndpoint").disabled=e,document.getElementById("txtAmount").disabled=e,document.getElementById("txtBalanceUnder").disabled=e,document.getElementById("txtTimeout").disabled=e,document.getElementById("btnLogin").disabled=e,document.getElementById("btnLogout").disabled=e,document.getElementById("btnUpdateAmount5").disabled=e,document.getElementById("btnUpdateAmount6").disabled=e,document.getElementById("btnUpdateTimeout1").disabled=e,document.getElementById("btnUpdateTimeout4").disabled=e,document.getElementById("btnUpdateTimeout5").disabled=e,document.getElementById("txtCPUUnder").disabled=e}function h(e,t,n,o,u,i,d){var a=document.getElementById(e).value.split(" ")[0];a=new Number(a).valueOf(),isNaN(a)&&(a=n);t=new Number(t).valueOf();isNaN(t)&&(t=1);var l=a*t;i>0&&l<i&&(l=i),d>0&&l>d&&(l=d),l=new Number(l).toFixed(o),void 0!=u&&u.length>0&&(l=l+" "+u),document.getElementById(e).value=l}function L(){return null==s||null==s.accounts||0==s.accounts.length?g:s.accounts[0].name}function U(e,t){S()?(v(),scatter.suggestNetwork(m).then(()=>{const n={accounts:[m]};scatter.getIdentity(n).then(function(n){if(!n)return t(null);s=n,document.getElementById("lbUserName").innerHTML=s.accounts[0].name,e()}).catch(e=>{t(e)})}).catch(e=>{t(e)})):t("scatter required")}function x(e,t,n,u,i){if(null==s)U(()=>{x(e,t,n,u,i)},i);else{const d=s.accounts.find(e=>e.blockchain===m.blockchain),a={authorization:[d.name+"@"+d.authority],broadcast:!0,sign:!0};o.transfer(d.name,e,t,n,a).then(e=>{u(e)}).catch(e=>{i(e)})}}function N(){null!=s?(E(new Date+" 开始向CPU租用1天的CPU资源，价格是：0.1000 EOS 一天"),x("cpubankeosio","0.1000 EOS","1d "+L()+" cpu",function(e){document.getElementById("rentResult").innerHTML="成功租用了1天的CPU资源",E(new Date+" 交易ID: "+e.transaction_id+" 成功租用了1天的CPU资源")},function(e){var t=void 0==e.message?JSON.parse(e).error.details[0].message:e.message;return"User rejected the signature request"==t||"Invalid packed transaction"==t?(document.getElementById("rentResult").innerHTML="用户取消租用CPU",void E(new Date+" 用户取消租用CPU")):"assertion failure with message: overdrawn balance"==t?(document.getElementById("rentResult").innerHTML="租用失败：CPU银行正在备货中，请稍后重试",void E(new Date+" 租用失败：CPU银行正在备货中，请稍后重试")):(document.getElementById("rentResult").innerHTML='租用失败："'+t+'"',void E(new Date+' 租用失败："'+t+'"'))})):E("请登陆")}function O(){S()?scatter.connect("FARMEOSHELPER").then(e=>{e?U(function(){document.getElementById("btnLogin").style.display="none",document.getElementById("btnLogout").style.display="",E("登陆成功："+JSON.stringify(s))},function(e){E("登陆出错："+JSON.stringify(e)+"，请关闭重新打开或者刷新本页面")}):E("未连接")}):alert("scatter required")}function w(){1!=u?s&&(s=null,S()&&scatter.forgetIdentity().then(()=>{document.getElementById("lbUserName").innerHTML="",document.getElementById("btnLogin").style.display="",document.getElementById("btnLogout").style.display="none"})):alert("请先停止脚本")}function S(){return void 0!==scatter}function P(){var e=document.getElementById("panelSetup").style.display;document.getElementById("panelSetup").style.display=""==e?"none":""}setTimeout(function e(){if(""!=L())try{o.getAccount({account_name:L()}).then(t=>{var n=t.core_liquid_balance;a=0==t.length?0:new Number(n.split(" ")[0]).valueOf(),document.getElementById("lbBalance").innerText=n;var o=t.cpu_limit;r=document.getElementById("lbCPUAvailable").innerHTML=new Number(100*o.available/o.max).toFixed(2)+"%",c=o.available>0&&100*o.available/o.max>=f,setTimeout(e,1e3)}).catch(t=>{E("检查账号出错："+JSON.stringify(t)),setTimeout(e,1e3)})}catch(t){E("检查账号出错："+JSON.stringify(t)),setTimeout(e,1e3)}else setTimeout(e,1e3)},100),setTimeout(function(){document.getElementById("btnLogin").addEventListener("click",O),document.getElementById("btnLogout").addEventListener("click",w),document.getElementById("btnUpdateAmount5").addEventListener("click",function(){h("txtAmount",2,.5,4,"EOS",.5,100)}),document.getElementById("btnUpdateAmount6").addEventListener("click",function(){h("txtAmount",.5,.5,4,"EOS",.5,100)}),document.getElementById("btnRent").addEventListener("btnRent",N),document.getElementById("btnUpdateTimeout1").addEventListener("click",function(){!function(e,t){document.getElementById(e).value=t}("txtTimeout","100")}),document.getElementById("btnUpdateTimeout4").addEventListener("click",function(){h("txtTimeout",2,1200,0,"",100,0)}),document.getElementById("btnUpdateTimeout5").addEventListener("click",function(){h("txtTimeout",.5,1200,0,"",100,0)}),document.getElementById("btnStart").addEventListener("click",I),document.getElementById("btnStop").addEventListener("click",B),document.getElementById("btnToggleSetup").addEventListener("click",P)},1e3)}]);